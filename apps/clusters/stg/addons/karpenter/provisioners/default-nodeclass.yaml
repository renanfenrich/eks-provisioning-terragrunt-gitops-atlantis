apiVersion: karpenter.k8s.aws/v1beta1
kind: NodeClass
metadata:
  name: default
spec:
  amiFamily: AL2023
  role: "arn:aws:iam::<account_id_stg>:role/stg-karpenter-node"
  tags:
    environment: stg
    finops_scope: spot
    cost_center: platform-stg
    business_unit: infrastructure
    service: kubernetes
    application: shared-eks
    project: shared-infra
    managed_by: karpenter
    owner: platform-team
    observability: enabled
    Name: stg-karpenter
    name: stg-karpenter
    kubernetes.io/cluster/stg-eks: owned
  subnetSelectorTerms:
    - tags:
        Name: stg-vpc-private*
  securityGroupSelectorTerms:
    - tags:
        aws:eks:cluster-name: stg-eks
  blockDeviceMappings:
    - deviceName: /dev/xvda
      ebs:
        volumeSize: 60Gi
        volumeType: gp3
        encrypted: true
